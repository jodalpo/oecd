<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê³¨í”„ OECD ê²Œì„</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(45deg, #2c3e50, #3498db);
            color: white;
            padding: 20px;
            text-align: center;
        }

        .header h1 {
            font-size: 24px;
            margin-bottom: 5px;
        }

        .header p {
            font-size: 14px;
            opacity: 0.9;
        }

        .section {
            padding: 20px;
            border-bottom: 1px solid #eee;
        }

        .section:last-child {
            border-bottom: none;
        }

        .section-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #2c3e50;
        }

        .player-input {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }

        .player-input input {
            flex: 1;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
        }

        .player-input input:focus {
            outline: none;
            border-color: #3498db;
        }

        .add-player-btn {
            background: #27ae60;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
        }

        .add-player-btn:hover {
            background: #229954;
        }

        .remove-player-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
        }

        .remove-player-btn:hover {
            background: #c0392b;
        }

        .rules-section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
        }

        .rule-item {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        .rule-item input[type="number"] {
            width: 80px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 6px;
            text-align: center;
        }

        .rule-item label {
            flex: 1;
            font-size: 14px;
        }

        .holes-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .hole-card {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 15px;
            transition: all 0.3s ease;
        }

        .hole-card:hover {
            border-color: #3498db;
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.2);
        }

        .hole-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .hole-number {
            font-size: 18px;
            font-weight: bold;
            color: #2c3e50;
        }

        .hole-reset-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 6px 10px;
            border-radius: 6px;
            font-size: 12px;
            cursor: pointer;
        }

        .hole-reset-btn:hover {
            background: #c0392b;
        }

        .player-score {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 8px;
            padding: 8px;
            background: #f8f9fa;
            border-radius: 6px;
        }

        .player-name {
            flex: 1;
            font-size: 14px;
            font-weight: 500;
        }

        .oecd-rules-container {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            flex: 1;
        }

        .oecd-rule {
            padding: 6px 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 12px;
            background: white;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .oecd-rule:hover {
            background: #f0f0f0;
        }

        .oecd-rule.selected {
            background: #3498db;
            color: white;
            border-color: #3498db;
        }

        .add-rule-btn {
            background: #27ae60;
            color: white;
            border: none;
            padding: 6px 8px;
            border-radius: 4px;
            font-size: 12px;
            cursor: pointer;
        }

        .add-rule-btn:hover {
            background: #229954;
        }

        .custom-rule-section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
            border: 2px dashed #dee2e6;
        }

        .custom-rule-input {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            align-items: center;
        }

        .custom-rule-input input[type="text"] {
            flex: 1;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }

        .custom-rule-input input[type="number"] {
            width: 100px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 6px;
            text-align: center;
            font-size: 14px;
        }

        .add-custom-rule-btn {
            background: #9b59b6;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
        }

        .add-custom-rule-btn:hover {
            background: #8e44ad;
        }

        .custom-rules-list {
            margin-top: 10px;
        }

        .custom-rule-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px;
            background: white;
            border-radius: 6px;
            margin-bottom: 5px;
            border: 1px solid #e9ecef;
        }

        .custom-rule-info {
            flex: 1;
        }

        .custom-rule-name {
            font-weight: 500;
            font-size: 14px;
        }

        .custom-rule-amount {
            font-size: 12px;
            color: #6c757d;
        }

        .remove-custom-rule-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }

        .remove-custom-rule-btn:hover {
            background: #c0392b;
        }

        .total-section {
            background: linear-gradient(45deg, #2c3e50, #34495e);
            color: white;
            padding: 20px;
            border-radius: 0 0 20px 20px;
        }

        .total-title {
            font-size: 18px;
            margin-bottom: 15px;
            text-align: center;
        }

        .total-scores {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
        }

        .total-score-item {
            background: rgba(255,255,255,0.1);
            padding: 10px;
            border-radius: 8px;
            text-align: center;
        }

        .total-score-name {
            font-size: 12px;
            opacity: 0.8;
            margin-bottom: 5px;
        }

        .total-score-value {
            font-size: 18px;
            font-weight: bold;
        }

        .btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
        }

        .btn:hover {
            background: #2980b9;
        }

        .btn-secondary {
            background: #95a5a6;
        }

        .btn-secondary:hover {
            background: #7f8c8d;
        }

        @media (max-width: 480px) {
            body {
                padding: 10px;
            }
            
            .container {
                border-radius: 15px;
            }
            
            .header h1 {
                font-size: 20px;
            }
            
            .player-input {
                flex-direction: column;
            }
            
            .holes-grid {
                grid-template-columns: 1fr;
            }
            
            .total-scores {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸŒï¸ ê³¨í”„ OECD ê²Œì„</h1>
            <p>í”Œë ˆì´ì–´ì™€ ë£°ì„ ì„¤ì •í•˜ê³  OECD í˜ë„í‹°ë¥¼ ê´€ë¦¬í•˜ì„¸ìš”</p>
        </div>

        <!-- í”Œë ˆì´ì–´ ì„¤ì • ì„¹ì…˜ -->
        <div class="section">
            <div class="section-title">ğŸ‘¥ í”Œë ˆì´ì–´ ì„¤ì • (ìµœëŒ€ 5ëª…)</div>
            <div id="playerInputs">
                <div class="player-input">
                    <input type="text" placeholder="í”Œë ˆì´ì–´ 1 ì´ë¦„" maxlength="10">
                    <button class="remove-player-btn" onclick="removePlayer(this)" style="display: none;">ì‚­ì œ</button>
                </div>
            </div>
            <div style="display: flex; gap: 10px; margin-top: 10px;">
                <button class="add-player-btn" onclick="addPlayer()">í”Œë ˆì´ì–´ ì¶”ê°€</button>
                <button class="btn btn-secondary" onclick="resetAll()">ì „ì²´ ì´ˆê¸°í™”</button>
            </div>
        </div>

        <!-- OECD ë£° ì„¤ì • ì„¹ì…˜ -->
        <div class="section">
            <div class="section-title">ğŸ“‹ OECD ë£° ì„¤ì •</div>
            <div class="rules-section">
                <div class="rule-item">
                    <label>ì˜¤ë¹„ (OB)</label>
                    <input type="number" id="obRule" value="1000" min="0" step="100">
                    <span>ì›</span>
                </div>
                <div class="rule-item">
                    <label>í•´ì €ë“œ (Hazard)</label>
                    <input type="number" id="hazardRule" value="1000" min="0" step="100">
                    <span>ì›</span>
                </div>
                <div class="rule-item">
                    <label>ë©€ë¦¬ê±´ (Mulligan)</label>
                    <input type="number" id="mulliganRule" value="1000" min="0" step="100">
                    <span>ì›</span>
                </div>
                <div class="rule-item">
                    <label>ë²™ì»¤ (Bunker)</label>
                    <input type="number" id="bunkerRule" value="1000" min="0" step="100">
                    <span>ì›</span>
                </div>
                <div class="rule-item">
                    <label>ì“°ë¦¬í¼íŠ¸ (3-Putt)</label>
                    <input type="number" id="threePuttRule" value="1000" min="0" step="100">
                    <span>ì›</span>
                </div>
                <div class="rule-item">
                    <label>íŠ¸ë¦¬í”Œ ë³´ê¸° (Triple Bogey)</label>
                    <input type="number" id="tripleBogeyRule" value="1000" min="0" step="100">
                    <span>ì›</span>
                </div>
            </div>
            
            <!-- ì»¤ìŠ¤í…€ ë£° ì¶”ê°€ ì„¹ì…˜ -->
            <div class="custom-rule-section">
                <div class="section-title" style="font-size: 16px; margin-bottom: 10px;">ğŸ¯ ì»¤ìŠ¤í…€ ë£° ì¶”ê°€</div>
                <div class="custom-rule-input">
                    <input type="text" id="customRuleName" placeholder="ë£° ì´ë¦„ (ì˜ˆ: ì˜¤ë¹„, ë©€ë¦¬ê±´, ë²„ë””)" maxlength="15">
                    <input type="number" id="customRuleAmount" placeholder="ê¸ˆì•¡ (ìŒìˆ˜ ê°€ëŠ¥)" step="100">
                    <span>ì›</span>
                    <button class="add-custom-rule-btn" onclick="addCustomRule()">ì¶”ê°€</button>
                </div>
                <div class="custom-rules-list" id="customRulesList">
                    <!-- ì»¤ìŠ¤í…€ ë£°ë“¤ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                </div>
            </div>
        </div>

        <!-- í™€ë³„ OECD ë£° ê´€ë¦¬ ì„¹ì…˜ -->
        <div class="section">
            <div class="section-title">â›³ í™€ë³„ OECD ë£° ê´€ë¦¬</div>
            <div class="holes-grid" id="holesGrid">
                <!-- í™€ ì¹´ë“œë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
            </div>
        </div>

        <!-- ì´ì  ì„¹ì…˜ -->
        <div class="total-section">
            <div class="total-title">ğŸ† ìµœì¢… ê²°ê³¼</div>
            <div class="total-scores" id="totalScores">
                <!-- ì´ì ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
            </div>
        </div>
    </div>

    <script>
        let players = [];
        let rules = {
            ob: 1000,
            hazard: 500,
            bunker: 300,
            threePutt: 200,
            tripleBogey: 1000
        };
        let customRules = {};

        // í”Œë ˆì´ì–´ ì¶”ê°€
        function addPlayer() {
            const playerInputs = document.getElementById('playerInputs');
            const currentPlayers = playerInputs.children.length;
            
            if (currentPlayers >= 5) {
                alert('ìµœëŒ€ 5ëª…ê¹Œì§€ë§Œ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                return;
            }

            const playerDiv = document.createElement('div');
            playerDiv.className = 'player-input';
            playerDiv.innerHTML = `
                <input type="text" placeholder="í”Œë ˆì´ì–´ ${currentPlayers + 1} ì´ë¦„" maxlength="10">
                <button class="remove-player-btn" onclick="removePlayer(this)">ì‚­ì œ</button>
            `;
            
            playerInputs.appendChild(playerDiv);
            updateHoles();
        }

        // í”Œë ˆì´ì–´ ì‚­ì œ
        function removePlayer(button) {
            const playerInputs = document.getElementById('playerInputs');
            if (playerInputs.children.length > 1) {
                button.parentElement.remove();
                updateHoles();
            }
        }

        // í”Œë ˆì´ì–´ ëª©ë¡ ì—…ë°ì´íŠ¸
        function updatePlayers() {
            players = [];
            const inputs = document.querySelectorAll('#playerInputs input');
            inputs.forEach(input => {
                if (input.value.trim()) {
                    players.push(input.value.trim());
                }
            });
        }

        // ì»¤ìŠ¤í…€ ë£° ì¶”ê°€
        function addCustomRule() {
            const nameInput = document.getElementById('customRuleName');
            const amountInput = document.getElementById('customRuleAmount');
            
            const name = nameInput.value.trim();
            const amount = parseInt(amountInput.value) || 0;
            
            if (!name) {
                alert('ë£° ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            if (amount === 0) {
                alert('ê¸ˆì•¡ì„ ì…ë ¥í•´ì£¼ì„¸ìš”. (ìŒìˆ˜ë„ ê°€ëŠ¥í•©ë‹ˆë‹¤)');
                return;
            }
            
            // ê¸°ë³¸ ë£°ê³¼ ì¤‘ë³µ í™•ì¸
            const basicRuleNames = ['ì˜¤ë¹„', 'í•´ì €ë“œ', 'ë²™ì»¤', 'ì“°ë¦¬í¼íŠ¸', 'íŠ¸ë¦¬í”Œë³´ê¸°'];
            if (basicRuleNames.includes(name)) {
                alert('ê¸°ë³¸ ë£°ê³¼ ë™ì¼í•œ ì´ë¦„ì€ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            // ì»¤ìŠ¤í…€ ë£° ì¤‘ë³µ í™•ì¸
            if (customRules[name]) {
                alert('ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ë£° ì´ë¦„ì…ë‹ˆë‹¤.');
                return;
            }
            
            // ì»¤ìŠ¤í…€ ë£° ì¶”ê°€
            const ruleKey = 'custom_' + Date.now();
            customRules[name] = { key: ruleKey, amount: amount };
            
            // UIì— í‘œì‹œ
            displayCustomRules();
            
            // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
            nameInput.value = '';
            amountInput.value = '';
            
            // í™€ ì—…ë°ì´íŠ¸
            updateHoles();
        }
        
        // ì»¤ìŠ¤í…€ ë£° í‘œì‹œ
        function displayCustomRules() {
            const customRulesList = document.getElementById('customRulesList');
            customRulesList.innerHTML = '';
            
            Object.entries(customRules).forEach(([name, rule]) => {
                const ruleItem = document.createElement('div');
                ruleItem.className = 'custom-rule-item';
                const amountText = rule.amount >= 0 ? 
                    `+${rule.amount.toLocaleString()}ì›` : 
                    `${rule.amount.toLocaleString()}ì›`;
                const amountColor = rule.amount >= 0 ? '#e74c3c' : '#2980b9';
                
                ruleItem.innerHTML = `
                    <div class="custom-rule-info">
                        <div class="custom-rule-name">${name}</div>
                        <div class="custom-rule-amount" style="color: ${amountColor};">${amountText}</div>
                    </div>
                    <button class="remove-custom-rule-btn" onclick="removeCustomRule('${name}')">ì‚­ì œ</button>
                `;
                customRulesList.appendChild(ruleItem);
            });
        }
        
        // ì»¤ìŠ¤í…€ ë£° ì‚­ì œ
        function removeCustomRule(name) {
            delete customRules[name];
            displayCustomRules();
            updateHoles();
        }
        

        
        // íŠ¹ì • í™€ ì´ˆê¸°í™”
        function resetHole(holeNumber) {
            if (confirm(`${holeNumber}ë²ˆ í™€ì˜ ëª¨ë“  ë£°ì„ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                for (let playerIndex = 0; playerIndex < players.length; playerIndex++) {
                    const rulesContainer = document.getElementById(`rules_${holeNumber}_${playerIndex}`);
                    if (rulesContainer) {
                        // ì„ íƒëœ ë£°ë“¤ë§Œ ì œê±° (ì¶”ê°€ ë²„íŠ¼ì€ ìœ ì§€)
                        const selectedRules = rulesContainer.querySelectorAll('.oecd-rule.selected');
                        selectedRules.forEach(rule => rule.remove());
                    }
                }
                updateTotal();
            }
        }
        
        // ì „ì²´ ì´ˆê¸°í™”
        function resetAll() {
            if (confirm('ëª¨ë“  ë°ì´í„°ë¥¼ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n(í”Œë ˆì´ì–´, ë£° ì„¤ì •, ì„ íƒëœ ë£° ëª¨ë‘ ì‚­ì œë©ë‹ˆë‹¤)')) {
                // í”Œë ˆì´ì–´ ì´ˆê¸°í™”
                const playerInputs = document.getElementById('playerInputs');
                playerInputs.innerHTML = `
                    <div class="player-input">
                        <input type="text" placeholder="í”Œë ˆì´ì–´ 1 ì´ë¦„" maxlength="10">
                        <button class="remove-player-btn" onclick="removePlayer(this)" style="display: none;">ì‚­ì œ</button>
                    </div>
                `;
                
                // ê¸°ë³¸ ë£° ì´ˆê¸°í™”
                document.getElementById('obRule').value = '1000';
                document.getElementById('hazardRule').value = '1000';
                document.getElementById('mulliganRule').value = '1000';
                document.getElementById('bunkerRule').value = '1000';
                document.getElementById('threePuttRule').value = '1000';
                document.getElementById('tripleBogeyRule').value = '1000';
                
                // ì»¤ìŠ¤í…€ ë£° ì´ˆê¸°í™”
                customRules = {};
                displayCustomRules();
                
                // ëª¨ë“  í™€ì˜ ì„ íƒëœ ë£° ì´ˆê¸°í™”
                for (let hole = 1; hole <= 18; hole++) {
                    for (let playerIndex = 0; playerIndex < 5; playerIndex++) {
                        const rulesContainer = document.getElementById(`rules_${hole}_${playerIndex}`);
                        if (rulesContainer) {
                            const selectedRules = rulesContainer.querySelectorAll('.oecd-rule.selected');
                            selectedRules.forEach(rule => rule.remove());
                        }
                    }
                }
                
                // ë³€ìˆ˜ ì´ˆê¸°í™”
                players = [];
                rules = {
                    ob: 1000,
                    hazard: 1000,
                    mulligan: 1000,
                    bunker: 1000,
                    threePutt: 1000,
                    tripleBogey: 1000
                };
                
                updateHoles();
                updateTotal();
                
                // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ì´ˆê¸°í™”
                localStorage.removeItem('golfOECDGame');
            }
        }
        
        // ë£° ì—…ë°ì´íŠ¸
        function updateRules() {
            rules.ob = parseInt(document.getElementById('obRule').value) || 0;
            rules.hazard = parseInt(document.getElementById('hazardRule').value) || 0;
            rules.mulligan = parseInt(document.getElementById('mulliganRule').value) || 0;
            rules.bunker = parseInt(document.getElementById('bunkerRule').value) || 0;
            rules.threePutt = parseInt(document.getElementById('threePuttRule').value) || 0;
            rules.tripleBogey = parseInt(document.getElementById('tripleBogeyRule').value) || 0;
        }

        // í™€ ì¹´ë“œ ìƒì„±
        function createHoleCard(holeNumber) {
            return `
                <div class="hole-card">
                    <div class="hole-header">
                        <span class="hole-number">${holeNumber}ë²ˆ í™€</span>
                        <button class="hole-reset-btn" onclick="resetHole(${holeNumber})">ì´ˆê¸°í™”</button>
                    </div>
                    <div class="hole-scores" id="hole${holeNumber}">
                        ${players.map((player, index) => `
                            <div class="player-score">
                                <span class="player-name">${player}</span>
                                <div class="oecd-rules-container" id="rules_${holeNumber}_${index}">
                                    <button class="add-rule-btn" onclick="addRule(${holeNumber}, ${index})">+ ë£° ì¶”ê°€</button>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        // í™€ ì—…ë°ì´íŠ¸
        function updateHoles() {
            updatePlayers();
            const holesGrid = document.getElementById('holesGrid');
            holesGrid.innerHTML = '';
            
            for (let i = 1; i <= 18; i++) {
                holesGrid.innerHTML += createHoleCard(i);
            }
            
            updateTotal();
        }

        // ë£° ì¶”ê°€ í•¨ìˆ˜
        function addRule(holeNumber, playerIndex) {
            const rulesContainer = document.getElementById(`rules_${holeNumber}_${playerIndex}`);
            
            // ê¸°ë³¸ ë£° íƒ€ì…
            const ruleTypes = [
                { key: 'ob', name: 'ì˜¤ë¹„', color: '#e74c3c' },
                { key: 'hazard', name: 'í•´ì €ë“œ', color: '#f39c12' },
                { key: 'mulligan', name: 'ë©€ë¦¬ê±´', color: '#e74e22' },
                { key: 'bunker', name: 'ë²™ì»¤', color: '#f1c40f' },
                { key: 'threePutt', name: 'ì“°ë¦¬í¼íŠ¸', color: '#9b59b6' },
                { key: 'tripleBogey', name: 'íŠ¸ë¦¬í”Œë³´ê¸°', color: '#e67e22' }
            ];
            
            // ì»¤ìŠ¤í…€ ë£° ì¶”ê°€
            Object.entries(customRules).forEach(([name, rule]) => {
                const color = rule.amount >= 0 ? '#6c757d' : '#2980b9'; // ìŒìˆ˜ëŠ” ì´ˆë¡ìƒ‰
                ruleTypes.push({
                    key: rule.key,
                    name: name,
                    color: color,
                    amount: rule.amount
                });
            });

            // ëª¨ë“  ë£°ì„ ì‚¬ìš© ê°€ëŠ¥í•˜ê²Œ ì„¤ì • (ì¤‘ë³µ ì„ íƒ í—ˆìš©)
            const availableRules = ruleTypes;

            if (availableRules.length === 0) {
                alert('ì‚¬ìš© ê°€ëŠ¥í•œ ë£°ì´ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            // ë£° ì„ íƒ ë“œë¡­ë‹¤ìš´ ìƒì„±
            const select = document.createElement('select');
            select.style.cssText = 'padding: 4px; margin: 2px; border-radius: 4px; font-size: 12px;';
            select.innerHTML = '<option value="">ë£° ì„ íƒ</option>' + 
                availableRules.map(rule => {
                    const amount = rule.amount || rules[rule.key] || 0;
                    const amountText = amount >= 0 ? 
                        `${amount}ì›` : 
                        `${amount}ì›`;
                    return `<option value="${rule.key}">${rule.name} (${amountText})</option>`;
                }).join('');

            select.addEventListener('change', function() {
                if (this.value) {
                    const selectedRule = availableRules.find(r => r.key === this.value);
                    const ruleElement = document.createElement('span');
                    ruleElement.className = 'oecd-rule selected';
                    ruleElement.dataset.rule = this.value;
                    ruleElement.style.backgroundColor = selectedRule.color;
                    ruleElement.style.borderColor = selectedRule.color;
                    ruleElement.textContent = selectedRule.name;
                    
                    ruleElement.addEventListener('click', function() {
                        this.remove();
                        updateTotal();
                    });

                    rulesContainer.insertBefore(ruleElement, rulesContainer.querySelector('.add-rule-btn'));
                    this.remove();
                    updateTotal();
                }
            });

            rulesContainer.insertBefore(select, rulesContainer.querySelector('.add-rule-btn'));
        }

        // ì´ì  ê³„ì‚° ë° ì—…ë°ì´íŠ¸
        function updateTotal() {
            updatePlayers();
            updateRules();
            
            const playerTotals = {};
            players.forEach(player => {
                playerTotals[player] = { penalty: 0 };
            });

            // ê° í™€ì˜ í˜ë„í‹° ê³„ì‚°
            for (let hole = 1; hole <= 18; hole++) {
                for (let playerIndex = 0; playerIndex < players.length; playerIndex++) {
                    const rulesContainer = document.getElementById(`rules_${hole}_${playerIndex}`);
                    if (!rulesContainer) continue;

                    const selectedRules = rulesContainer.querySelectorAll('.oecd-rule.selected');
                    const player = players[playerIndex];

                    if (player) {
                        selectedRules.forEach(ruleElement => {
                            const ruleKey = ruleElement.dataset.rule;
                            
                            // ê¸°ë³¸ ë£°ì¸ ê²½ìš°
                            if (rules[ruleKey]) {
                                playerTotals[player].penalty += rules[ruleKey];
                            }
                            // ì»¤ìŠ¤í…€ ë£°ì¸ ê²½ìš°
                            else {
                                const customRule = Object.values(customRules).find(rule => rule.key === ruleKey);
                                if (customRule) {
                                    // ì»¤ìŠ¤í…€ ë£°ì˜ ê¸ˆì•¡ì„ ê·¸ëŒ€ë¡œ ì‚¬ìš© (ìŒìˆ˜ë„ í¬í•¨)
                                    playerTotals[player].penalty += customRule.amount;
                                }
                            }
                        });
                    }
                }
            }

            // ì´ì  í‘œì‹œ ì—…ë°ì´íŠ¸
            const totalScores = document.getElementById('totalScores');
            totalScores.innerHTML = '';

            Object.entries(playerTotals).forEach(([player, total]) => {
                const totalElement = document.createElement('div');
                totalElement.className = 'total-score-item';
                const penaltyText = total.penalty >= 0 ? 
                    `+${total.penalty.toLocaleString()}ì›` : 
                    `${total.penalty.toLocaleString()}ì›`;
                const penaltyColor = total.penalty >= 0 ? '#e74c3c' : '#2980b9';
                
                totalElement.innerHTML = `
                    <div class="total-score-name">${player}</div>
                    <div class="total-score-value" style="font-size: 16px; color: ${penaltyColor};">
                        ${penaltyText}
                    </div>
                `;
                totalScores.appendChild(totalElement);
            });
        }

        // ë£° ë³€ê²½ ì‹œ í™€ ì—…ë°ì´íŠ¸
        document.addEventListener('DOMContentLoaded', function() {
            // ë£° ì…ë ¥ í•„ë“œì— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
            const ruleInputs = document.querySelectorAll('.rules-section input');
            ruleInputs.forEach(input => {
                input.addEventListener('change', function() {
                    updateRules();
                    updateHoles();
                });
            });

            // í”Œë ˆì´ì–´ ì…ë ¥ í•„ë“œì— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
            document.addEventListener('input', function(e) {
                if (e.target.matches('#playerInputs input')) {
                    updateHoles();
                }
            });

            // ì´ˆê¸° í™€ ìƒì„±
            updateHoles();
            
            // ì»¤ìŠ¤í…€ ë£° í‘œì‹œ ì´ˆê¸°í™”
            displayCustomRules();
        });

        // í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ ì‹œ ë°ì´í„° ë³´ì¡´
        window.addEventListener('beforeunload', function() {
            const gameData = {
                players: players,
                rules: rules,
                customRules: customRules,
                selectedRules: {}
            };

            // ê° í™€ì˜ ì„ íƒëœ ë£° ì €ì¥
            for (let hole = 1; hole <= 18; hole++) {
                gameData.selectedRules[hole] = {};
                for (let playerIndex = 0; playerIndex < players.length; playerIndex++) {
                    const rulesContainer = document.getElementById(`rules_${hole}_${playerIndex}`);
                    if (rulesContainer) {
                        const selectedRules = Array.from(rulesContainer.querySelectorAll('.oecd-rule.selected'))
                            .map(rule => rule.dataset.rule);
                        gameData.selectedRules[hole][playerIndex] = selectedRules;
                    }
                }
            }

            localStorage.setItem('golfOECDGame', JSON.stringify(gameData));
        });

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ë°ì´í„° ë³µì›
        window.addEventListener('load', function() {
            const savedData = localStorage.getItem('golfOECDGame');
            if (savedData) {
                const gameData = JSON.parse(savedData);
                
                // í”Œë ˆì´ì–´ ë³µì›
                if (gameData.players && gameData.players.length > 0) {
                    const playerInputs = document.getElementById('playerInputs');
                    playerInputs.innerHTML = '';
                    
                    gameData.players.forEach((player, index) => {
                        const playerDiv = document.createElement('div');
                        playerDiv.className = 'player-input';
                        playerDiv.innerHTML = `
                            <input type="text" value="${player}" maxlength="10">
                            ${index > 0 ? '<button class="remove-player-btn" onclick="removePlayer(this)">ì‚­ì œ</button>' : ''}
                        `;
                        playerInputs.appendChild(playerDiv);
                    });
                }
                
                // ë£° ë³µì›
                if (gameData.rules) {
                    Object.entries(gameData.rules).forEach(([key, value]) => {
                        const input = document.getElementById(key + 'Rule');
                        if (input) input.value = value;
                    });
                }
                
                // ì»¤ìŠ¤í…€ ë£° ë³µì›
                if (gameData.customRules) {
                    customRules = gameData.customRules;
                    displayCustomRules();
                }
                
                updateHoles();
                
                // ì„ íƒëœ ë£° ë³µì›
                setTimeout(() => {
                    if (gameData.selectedRules) {
                        const ruleTypes = [
                            { key: 'ob', name: 'ì˜¤ë¹„', color: '#e74c3c' },
                            { key: 'hazard', name: 'í•´ì €ë“œ', color: '#f39c12' },
                            { key: 'mulligan', name: 'ë©€ë¦¬ê±´', color: '#e74e22' },
                            { key: 'bunker', name: 'ë²™ì»¤', color: '#f1c40f' },
                            { key: 'threePutt', name: 'ì“°ë¦¬í¼íŠ¸', color: '#9b59b6' },
                            { key: 'tripleBogey', name: 'íŠ¸ë¦¬í”Œë³´ê¸°', color: '#e67e22' }
                        ];
                        
                        // ì»¤ìŠ¤í…€ ë£° ì¶”ê°€
                        Object.entries(customRules).forEach(([name, rule]) => {
                            const color = rule.amount >= 0 ? '#6c757d' : '#2980b9';
                            ruleTypes.push({
                                key: rule.key,
                                name: name,
                                color: color
                            });
                        });

                        Object.entries(gameData.selectedRules).forEach(([hole, playerRules]) => {
                            Object.entries(playerRules).forEach(([playerIndex, selectedRules]) => {
                                const rulesContainer = document.getElementById(`rules_${hole}_${playerIndex}`);
                                if (rulesContainer) {
                                    selectedRules.forEach(ruleKey => {
                                        const selectedRule = ruleTypes.find(r => r.key === ruleKey);
                                        if (selectedRule) {
                                            const ruleElement = document.createElement('span');
                                            ruleElement.className = 'oecd-rule selected';
                                            ruleElement.dataset.rule = ruleKey;
                                            ruleElement.style.backgroundColor = selectedRule.color;
                                            ruleElement.style.borderColor = selectedRule.color;
                                            ruleElement.textContent = selectedRule.name;
                                            
                                            ruleElement.addEventListener('click', function() {
                                                this.remove();
                                                updateTotal();
                                            });

                                            rulesContainer.insertBefore(ruleElement, rulesContainer.querySelector('.add-rule-btn'));
                                        }
                                    });
                                }
                            });
                        });
                        updateTotal();
                    }
                }, 100);
            }
        });
    </script>
</body>
</html>
