<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Í≥®ÌîÑ OECD Í≤åÏûÑ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(45deg, #2c3e50, #3498db);
            color: white;
            padding: 20px;
            text-align: center;
        }

        .header h1 {
            font-size: 24px;
            margin-bottom: 5px;
        }

        .header p {
            font-size: 14px;
            opacity: 0.9;
        }

        .section {
            padding: 20px;
            border-bottom: 1px solid #eee;
        }

        .section:last-child {
            border-bottom: none;
        }

        .section-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #2c3e50;
        }

        .player-input {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }

        .player-input input {
            flex: 1;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
        }

        .player-input input:focus {
            outline: none;
            border-color: #3498db;
        }

        .add-player-btn {
            background: #27ae60;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
        }

        .add-player-btn:hover {
            background: #229954;
        }

        .remove-player-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
        }

        .remove-player-btn:hover {
            background: #c0392b;
        }

        .rules-section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
        }

        .rule-item {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        .rule-item input[type="number"] {
            width: 80px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 6px;
            text-align: center;
        }

        .rule-item label {
            flex: 1;
            font-size: 14px;
        }

        .holes-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .hole-card {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 15px;
            transition: all 0.3s ease;
        }

        .hole-card:hover {
            border-color: #3498db;
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.2);
        }

        .hole-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .hole-number {
            font-size: 18px;
            font-weight: bold;
            color: #2c3e50;
        }

        .hole-reset-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 6px 10px;
            border-radius: 6px;
            font-size: 12px;
            cursor: pointer;
        }

        .hole-reset-btn:hover {
            background: #c0392b;
        }

        .player-score {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 8px;
            padding: 8px;
            background: #f8f9fa;
            border-radius: 6px;
        }

        .player-name {
            flex: 1;
            font-size: 14px;
            font-weight: 500;
        }

        .oecd-rules-container {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            flex: 1;
        }

        .oecd-rule {
            padding: 6px 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 12px;
            background: white;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .oecd-rule:hover {
            background: #f0f0f0;
        }

        .oecd-rule.selected {
            background: #3498db;
            color: white;
            border-color: #3498db;
        }

        .add-rule-btn {
            background: #27ae60;
            color: white;
            border: none;
            padding: 6px 8px;
            border-radius: 4px;
            font-size: 12px;
            cursor: pointer;
        }

        .add-rule-btn:hover {
            background: #229954;
        }

        .custom-rule-section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
            border: 2px dashed #dee2e6;
        }

        .custom-rule-input {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            align-items: center;
        }

        .custom-rule-input input[type="text"] {
            flex: 1;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }

        .custom-rule-input input[type="number"] {
            width: 100px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 6px;
            text-align: center;
            font-size: 14px;
        }

        .add-custom-rule-btn {
            background: #9b59b6;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
        }

        .add-custom-rule-btn:hover {
            background: #8e44ad;
        }

        .custom-rules-list {
            margin-top: 10px;
        }

        .custom-rule-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px;
            background: white;
            border-radius: 6px;
            margin-bottom: 5px;
            border: 1px solid #e9ecef;
        }

        .custom-rule-info {
            flex: 1;
        }

        .custom-rule-name {
            font-weight: 500;
            font-size: 14px;
        }

        .custom-rule-amount {
            font-size: 12px;
            color: #6c757d;
        }

        .remove-custom-rule-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }

        .remove-custom-rule-btn:hover {
            background: #c0392b;
        }

        .total-section {
            background: linear-gradient(45deg, #2c3e50, #34495e);
            color: white;
            padding: 20px;
            border-radius: 0 0 20px 20px;
        }

        .total-title {
            font-size: 18px;
            margin-bottom: 15px;
            text-align: center;
        }

        .total-scores {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
        }

        .total-score-item {
            background: rgba(255,255,255,0.1);
            padding: 10px;
            border-radius: 8px;
            text-align: center;
        }

        .total-score-name {
            font-size: 12px;
            opacity: 0.8;
            margin-bottom: 5px;
        }

        .total-score-value {
            font-size: 18px;
            font-weight: bold;
        }

        .btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
        }

        .btn:hover {
            background: #2980b9;
        }

        .btn-secondary {
            background: #95a5a6;
        }

        .btn-secondary:hover {
            background: #7f8c8d;
        }

        @media (max-width: 480px) {
            body {
                padding: 10px;
            }
            
            .container {
                border-radius: 15px;
            }
            
            .header h1 {
                font-size: 20px;
            }
            
            .player-input {
                flex-direction: column;
            }
            
            .holes-grid {
                grid-template-columns: 1fr;
            }
            
            .total-scores {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üèåÔ∏è Í≥®ÌîÑ OECD Í≤åÏûÑ</h1>
            <p>ÌîåÎ†àÏù¥Ïñ¥ÏôÄ Î£∞ÏùÑ ÏÑ§Ï†ïÌïòÍ≥† OECD ÌéòÎÑêÌã∞Î•º Í¥ÄÎ¶¨ÌïòÏÑ∏Ïöî</p>
        </div>

        <!-- ÌîåÎ†àÏù¥Ïñ¥ ÏÑ§Ï†ï ÏÑπÏÖò -->
        <div class="section">
            <div class="section-title">üë• ÌîåÎ†àÏù¥Ïñ¥ ÏÑ§Ï†ï (ÏµúÎåÄ 5Î™Ö)</div>
            <div id="playerInputs">
                <div class="player-input">
                    <input type="text" placeholder="ÌîåÎ†àÏù¥Ïñ¥ 1 Ïù¥Î¶Ñ" maxlength="10">
                    <button class="remove-player-btn" onclick="removePlayer(this)" style="display: none;">ÏÇ≠Ï†ú</button>
                </div>
            </div>
            <div style="display: flex; gap: 10px; margin-top: 10px;">
                <button class="add-player-btn" onclick="addPlayer()">ÌîåÎ†àÏù¥Ïñ¥ Ï∂îÍ∞Ä</button>
                <button class="btn btn-secondary" onclick="resetAll()">Ï†ÑÏ≤¥ Ï¥àÍ∏∞Ìôî</button>
            </div>
        </div>

        <!-- OECD Î£∞ ÏÑ§Ï†ï ÏÑπÏÖò -->
        <div class="section">
            <div class="section-title">üìã OECD Î£∞ ÏÑ§Ï†ï</div>
            <div class="rules-section">
                <div class="rule-item">
                    <label>Ïò§ÎπÑ (OB)</label>
                    <input type="number" id="obRule" value="1000" min="0" step="100">
                    <span>Ïõê</span>
                </div>
                <div class="rule-item">
                    <label>Ìï¥Ï†ÄÎìú (Hazard)</label>
                    <input type="number" id="hazardRule" value="1000" min="0" step="100">
                    <span>Ïõê</span>
                </div>
                <div class="rule-item">
                    <label>Î©ÄÎ¶¨Í±¥ (Mulligan)</label>
                    <input type="number" id="mulliganRule" value="1000" min="0" step="100">
                    <span>Ïõê</span>
                </div>
                <div class="rule-item">
                    <label>Î≤ôÏª§ (Bunker)</label>
                    <input type="number" id="bunkerRule" value="1000" min="0" step="100">
                    <span>Ïõê</span>
                </div>
                <div class="rule-item">
                    <label>Ïì∞Î¶¨ÌçºÌä∏ (3-Putt)</label>
                    <input type="number" id="threePuttRule" value="1000" min="0" step="100">
                    <span>Ïõê</span>
                </div>
                <div class="rule-item">
                    <label>Ìä∏Î¶¨Ìîå Î≥¥Í∏∞ (Triple Bogey)</label>
                    <input type="number" id="tripleBogeyRule" value="1000" min="0" step="100">
                    <span>Ïõê</span>
                </div>
            </div>
            
            <!-- Ïª§Ïä§ÌÖÄ Î£∞ Ï∂îÍ∞Ä ÏÑπÏÖò -->
            <div class="custom-rule-section">
                <div class="section-title" style="font-size: 16px; margin-bottom: 10px;">üéØ Ïª§Ïä§ÌÖÄ Î£∞ Ï∂îÍ∞Ä</div>
                <div class="custom-rule-input">
                    <input type="text" id="customRuleName" placeholder="Î£∞ Ïù¥Î¶Ñ (Ïòà: Ïò§ÎπÑ, Î©ÄÎ¶¨Í±¥, Î≤ÑÎîî)" maxlength="15">
                    <input type="number" id="customRuleAmount" placeholder="Í∏àÏï° (ÏùåÏàò Í∞ÄÎä•)" step="100">
                    <span>Ïõê</span>
                    <button class="add-custom-rule-btn" onclick="addCustomRule()">Ï∂îÍ∞Ä</button>
                </div>
                <div class="custom-rules-list" id="customRulesList">
                    <!-- Ïª§Ïä§ÌÖÄ Î£∞Îì§Ïù¥ Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§ -->
                </div>
            </div>
        </div>

        <!-- ÌôÄÎ≥Ñ OECD Î£∞ Í¥ÄÎ¶¨ ÏÑπÏÖò -->
        <div class="section">
            <div class="section-title">‚õ≥ ÌôÄÎ≥Ñ OECD Î£∞ Í¥ÄÎ¶¨</div>
            <div class="holes-grid" id="holesGrid">
                <!-- ÌôÄ Ïπ¥ÎìúÎì§Ïù¥ Ïó¨Í∏∞Ïóê ÎèôÏ†ÅÏúºÎ°ú ÏÉùÏÑ±Îê©ÎãàÎã§ -->
            </div>
        </div>

        <!-- Ï¥ùÏ†ê ÏÑπÏÖò -->
        <div class="total-section">
            <div class="total-title">üèÜ ÏµúÏ¢Ö Í≤∞Í≥º</div>
            <div class="total-scores" id="totalScores">
                <!-- Ï¥ùÏ†êÏù¥ Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§ -->
            </div>
        </div>
    </div>

    <script>
        let players = [];
        let rules = {
            ob: 1000,
            hazard: 500,
            bunker: 300,
            threePutt: 200,
            tripleBogey: 1000
        };
        let customRules = {};

        // ÌîåÎ†àÏù¥Ïñ¥ Ï∂îÍ∞Ä
        function addPlayer() {
            const playerInputs = document.getElementById('playerInputs');
            const currentPlayers = playerInputs.children.length;
            
            if (currentPlayers >= 5) {
                alert('ÏµúÎåÄ 5Î™ÖÍπåÏßÄÎßå Ï∂îÍ∞ÄÌï† Ïàò ÏûàÏäµÎãàÎã§.');
                return;
            }

            const playerDiv = document.createElement('div');
            playerDiv.className = 'player-input';
            playerDiv.innerHTML = `
                <input type="text" placeholder="ÌîåÎ†àÏù¥Ïñ¥ ${currentPlayers + 1} Ïù¥Î¶Ñ" maxlength="10">
                <button class="remove-player-btn" onclick="removePlayer(this)">ÏÇ≠Ï†ú</button>
            `;
            
            playerInputs.appendChild(playerDiv);
            updateHoles();
        }

        // ÌîåÎ†àÏù¥Ïñ¥ ÏÇ≠Ï†ú
        function removePlayer(button) {
            const playerInputs = document.getElementById('playerInputs');
            if (playerInputs.children.length > 1) {
                button.parentElement.remove();
                updateHoles();
            }
        }

        // ÌîåÎ†àÏù¥Ïñ¥ Î™©Î°ù ÏóÖÎç∞Ïù¥Ìä∏
        function updatePlayers() {
            players = [];
            const inputs = document.querySelectorAll('#playerInputs input');
            inputs.forEach(input => {
                if (input.value.trim()) {
                    players.push(input.value.trim());
                }
            });
        }

        // Ïª§Ïä§ÌÖÄ Î£∞ Ï∂îÍ∞Ä
        function addCustomRule() {
            const nameInput = document.getElementById('customRuleName');
            const amountInput = document.getElementById('customRuleAmount');
            
            const name = nameInput.value.trim();
            const amount = parseInt(amountInput.value) || 0;
            
            if (!name) {
                alert('Î£∞ Ïù¥Î¶ÑÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }
            
            if (amount === 0) {
                alert('Í∏àÏï°ÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî. (ÏùåÏàòÎèÑ Í∞ÄÎä•Ìï©ÎãàÎã§)');
                return;
            }
            
            // Í∏∞Î≥∏ Î£∞Í≥º Ï§ëÎ≥µ ÌôïÏù∏
            const basicRuleNames = ['Ïò§ÎπÑ', 'Ìï¥Ï†ÄÎìú', 'Î≤ôÏª§', 'Ïì∞Î¶¨ÌçºÌä∏', 'Ìä∏Î¶¨ÌîåÎ≥¥Í∏∞'];
            if (basicRuleNames.includes(name)) {
                alert('Í∏∞Î≥∏ Î£∞Í≥º ÎèôÏùºÌïú Ïù¥Î¶ÑÏùÄ ÏÇ¨Ïö©Ìï† Ïàò ÏóÜÏäµÎãàÎã§.');
                return;
            }
            
            // Ïª§Ïä§ÌÖÄ Î£∞ Ï§ëÎ≥µ ÌôïÏù∏
            if (customRules[name]) {
                alert('Ïù¥ÎØ∏ Ï°¥Ïû¨ÌïòÎäî Î£∞ Ïù¥Î¶ÑÏûÖÎãàÎã§.');
                return;
            }
            
            // Ïª§Ïä§ÌÖÄ Î£∞ Ï∂îÍ∞Ä
            const ruleKey = 'custom_' + Date.now();
            customRules[name] = { key: ruleKey, amount: amount };
            
            // UIÏóê ÌëúÏãú
            displayCustomRules();
            
            // ÏûÖÎ†• ÌïÑÎìú Ï¥àÍ∏∞Ìôî
            nameInput.value = '';
            amountInput.value = '';
            
            // ÌôÄ ÏóÖÎç∞Ïù¥Ìä∏
            updateHoles();
        }
        
        // Ïª§Ïä§ÌÖÄ Î£∞ ÌëúÏãú
        function displayCustomRules() {
            const customRulesList = document.getElementById('customRulesList');
            customRulesList.innerHTML = '';
            
            Object.entries(customRules).forEach(([name, rule]) => {
                const ruleItem = document.createElement('div');
                ruleItem.className = 'custom-rule-item';
                const amountText = rule.amount >= 0 ? 
                    `+${rule.amount.toLocaleString()}Ïõê` : 
                    `${rule.amount.toLocaleString()}Ïõê`;
                const amountColor = rule.amount >= 0 ? '#e74c3c' : '#2980b9';
                
                ruleItem.innerHTML = `
                    <div class="custom-rule-info">
                        <div class="custom-rule-name">${name}</div>
                        <div class="custom-rule-amount" style="color: ${amountColor};">${amountText}</div>
                    </div>
                    <button class="remove-custom-rule-btn" onclick="removeCustomRule('${name}')">ÏÇ≠Ï†ú</button>
                `;
                customRulesList.appendChild(ruleItem);
            });
        }
        
        // Ïª§Ïä§ÌÖÄ Î£∞ ÏÇ≠Ï†ú
        function removeCustomRule(name) {
            delete customRules[name];
            displayCustomRules();
            updateHoles();
        }
        

        
        // ÌäπÏ†ï ÌôÄ Ï¥àÍ∏∞Ìôî
        function resetHole(holeNumber) {
            if (confirm(`${holeNumber}Î≤à ÌôÄÏùò Î™®Îì† Î£∞ÏùÑ Ï¥àÍ∏∞ÌôîÌïòÏãúÍ≤†ÏäµÎãàÍπå?`)) {
                for (let playerIndex = 0; playerIndex < players.length; playerIndex++) {
                    const rulesContainer = document.getElementById(`rules_${holeNumber}_${playerIndex}`);
                    if (rulesContainer) {
                        // ÏÑ†ÌÉùÎêú Î£∞Îì§Îßå Ï†úÍ±∞ (Ï∂îÍ∞Ä Î≤ÑÌäºÏùÄ Ïú†ÏßÄ)
                        const selectedRules = rulesContainer.querySelectorAll('.oecd-rule.selected');
                        selectedRules.forEach(rule => rule.remove());
                    }
                }
                updateTotal();
            }
        }
        
        // Ï†ÑÏ≤¥ Ï¥àÍ∏∞Ìôî
        function resetAll() {
            if (confirm('Î™®Îì† Îç∞Ïù¥ÌÑ∞Î•º Ï¥àÍ∏∞ÌôîÌïòÏãúÍ≤†ÏäµÎãàÍπå?\n(ÌîåÎ†àÏù¥Ïñ¥, Î£∞ ÏÑ§Ï†ï, ÏÑ†ÌÉùÎêú Î£∞ Î™®Îëê ÏÇ≠Ï†úÎê©ÎãàÎã§)')) {
                // ÌîåÎ†àÏù¥Ïñ¥ Ï¥àÍ∏∞Ìôî
                const playerInputs = document.getElementById('playerInputs');
                playerInputs.innerHTML = `
                    <div class="player-input">
                        <input type="text" placeholder="ÌîåÎ†àÏù¥Ïñ¥ 1 Ïù¥Î¶Ñ" maxlength="10">
                        <button class="remove-player-btn" onclick="removePlayer(this)" style="display: none;">ÏÇ≠Ï†ú</button>
                    </div>
                `;
                
                // Í∏∞Î≥∏ Î£∞ Ï¥àÍ∏∞Ìôî
                document.getElementById('obRule').value = '1000';
                document.getElementById('hazardRule').value = '1000';
                document.getElementById('mulliganRule').value = '1000';
                document.getElementById('bunkerRule').value = '1000';
                document.getElementById('threePuttRule').value = '1000';
                document.getElementById('tripleBogeyRule').value = '1000';
                
                // Ïª§Ïä§ÌÖÄ Î£∞ Ï¥àÍ∏∞Ìôî
                customRules = {};
                displayCustomRules();
                
                // Î™®Îì† ÌôÄÏùò ÏÑ†ÌÉùÎêú Î£∞ Ï¥àÍ∏∞Ìôî
                for (let hole = 1; hole <= 18; hole++) {
                    for (let playerIndex = 0; playerIndex < 5; playerIndex++) {
                        const rulesContainer = document.getElementById(`rules_${hole}_${playerIndex}`);
                        if (rulesContainer) {
                            const selectedRules = rulesContainer.querySelectorAll('.oecd-rule.selected');
                            selectedRules.forEach(rule => rule.remove());
                        }
                    }
                }
                
                // Î≥ÄÏàò Ï¥àÍ∏∞Ìôî
                players = [];
                rules = {
                    ob: 1000,
                    hazard: 1000,
                    mulligan: 1000,
                    bunker: 1000,
                    threePutt: 1000,
                    tripleBogey: 1000
                };
                
                updateHoles();
                updateTotal();
                
                // Î°úÏª¨ Ïä§ÌÜ†Î¶¨ÏßÄ Ï¥àÍ∏∞Ìôî
                localStorage.removeItem('golfOECDGame');
            }
        }
        
        // Î£∞ ÏóÖÎç∞Ïù¥Ìä∏
        function updateRules() {
            rules.ob = parseInt(document.getElementById('obRule').value) || 0;
            rules.hazard = parseInt(document.getElementById('hazardRule').value) || 0;
            rules.mulligan = parseInt(document.getElementById('mulliganRule').value) || 0;
            rules.bunker = parseInt(document.getElementById('bunkerRule').value) || 0;
            rules.threePutt = parseInt(document.getElementById('threePuttRule').value) || 0;
            rules.tripleBogey = parseInt(document.getElementById('tripleBogeyRule').value) || 0;
        }

        // ÌôÄ Ïπ¥Îìú ÏÉùÏÑ±
        function createHoleCard(holeNumber) {
            return `
                <div class="hole-card">
                    <div class="hole-header">
                        <span class="hole-number">${holeNumber}Î≤à ÌôÄ</span>
                        <button class="hole-reset-btn" onclick="resetHole(${holeNumber})">Ï¥àÍ∏∞Ìôî</button>
                    </div>
                    <div class="hole-scores" id="hole${holeNumber}">
                        ${players.map((player, index) => `
                            <div class="player-score">
                                <span class="player-name">${player}</span>
                                <div class="oecd-rules-container" id="rules_${holeNumber}_${index}">
                                    <button class="add-rule-btn" onclick="addRule(${holeNumber}, ${index})">+ Î£∞ Ï∂îÍ∞Ä</button>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        // ÌôÄ ÏóÖÎç∞Ïù¥Ìä∏
        function updateHoles() {
            updatePlayers();
            const holesGrid = document.getElementById('holesGrid');
            holesGrid.innerHTML = '';
            
            for (let i = 1; i <= 18; i++) {
                holesGrid.innerHTML += createHoleCard(i);
            }
            
            updateTotal();
        }

        // Î£∞ Ï∂îÍ∞Ä Ìï®Ïàò
        function addRule(holeNumber, playerIndex) {
            const rulesContainer = document.getElementById(`rules_${holeNumber}_${playerIndex}`);
            
            // Í∏∞Î≥∏ Î£∞ ÌÉÄÏûÖ
            const ruleTypes = [
                { key: 'ob', name: 'Ïò§ÎπÑ', color: '#e74c3c' },
                { key: 'hazard', name: 'Ìï¥Ï†ÄÎìú', color: '#f39c12' },
                { key: 'mulligan', name: 'Î©ÄÎ¶¨Í±¥', color: '#e74e22' },
                { key: 'bunker', name: 'Î≤ôÏª§', color: '#f1c40f' },
                { key: 'threePutt', name: 'Ïì∞Î¶¨ÌçºÌä∏', color: '#9b59b6' },
                { key: 'tripleBogey', name: 'Ìä∏Î¶¨ÌîåÎ≥¥Í∏∞', color: '#e67e22' }
            ];
            
            // Ïª§Ïä§ÌÖÄ Î£∞ Ï∂îÍ∞Ä
            Object.entries(customRules).forEach(([name, rule]) => {
                const color = rule.amount >= 0 ? '#6c757d' : '#2980b9'; // ÏùåÏàòÎäî Ï¥àÎ°ùÏÉâ
                ruleTypes.push({
                    key: rule.key,
                    name: name,
                    color: color,
                    amount: rule.amount
                });
            });

            // Î™®Îì† Î£∞ÏùÑ ÏÇ¨Ïö© Í∞ÄÎä•ÌïòÍ≤å ÏÑ§Ï†ï (Ï§ëÎ≥µ ÏÑ†ÌÉù ÌóàÏö©)
            const availableRules = ruleTypes;

            if (availableRules.length === 0) {
                alert('ÏÇ¨Ïö© Í∞ÄÎä•Ìïú Î£∞Ïù¥ ÏóÜÏäµÎãàÎã§.');
                return;
            }

            // Î£∞ ÏÑ†ÌÉù ÎìúÎ°≠Îã§Ïö¥ ÏÉùÏÑ±
            const select = document.createElement('select');
            select.style.cssText = 'padding: 4px; margin: 2px; border-radius: 4px; font-size: 12px;';
            select.innerHTML = '<option value="">Î£∞ ÏÑ†ÌÉù</option>' + 
                availableRules.map(rule => {
                    const amount = rule.amount || rules[rule.key] || 0;
                    const amountText = amount >= 0 ? 
                        `${amount}Ïõê` : 
                        `${amount}Ïõê`;
                    return `<option value="${rule.key}">${rule.name} (${amountText})</option>`;
                }).join('');

            select.addEventListener('change', function() {
                if (this.value) {
                    const selectedRule = availableRules.find(r => r.key === this.value);
                    const ruleElement = document.createElement('span');
                    ruleElement.className = 'oecd-rule selected';
                    ruleElement.dataset.rule = this.value;
                    ruleElement.style.backgroundColor = selectedRule.color;
                    ruleElement.style.borderColor = selectedRule.color;
                    ruleElement.textContent = selectedRule.name;
                    
                    ruleElement.addEventListener('click', function() {
                        this.remove();
                        updateTotal();
                    });

                    rulesContainer.insertBefore(ruleElement, rulesContainer.querySelector('.add-rule-btn'));
                    this.remove();
                    updateTotal();
                }
            });

            rulesContainer.insertBefore(select, rulesContainer.querySelector('.add-rule-btn'));
        }

        // Ï¥ùÏ†ê Í≥ÑÏÇ∞ Î∞è ÏóÖÎç∞Ïù¥Ìä∏
        function updateTotal() {
            updatePlayers();
            updateRules();
            
            const playerTotals = {};
            players.forEach(player => {
                playerTotals[player] = { penalty: 0 };
            });

            // Í∞Å ÌôÄÏùò ÌéòÎÑêÌã∞ Í≥ÑÏÇ∞
            for (let hole = 1; hole <= 18; hole++) {
                for (let playerIndex = 0; playerIndex < players.length; playerIndex++) {
                    const rulesContainer = document.getElementById(`rules_${hole}_${playerIndex}`);
                    if (!rulesContainer) continue;

                    const selectedRules = rulesContainer.querySelectorAll('.oecd-rule.selected');
                    const player = players[playerIndex];

                    if (player) {
                        selectedRules.forEach(ruleElement => {
                            const ruleKey = ruleElement.dataset.rule;
                            
                            // Í∏∞Î≥∏ Î£∞Ïù∏ Í≤ΩÏö∞
                            if (rules[ruleKey]) {
                                playerTotals[player].penalty += rules[ruleKey];
                            }
                            // Ïª§Ïä§ÌÖÄ Î£∞Ïù∏ Í≤ΩÏö∞
                            else {
                                const customRule = Object.values(customRules).find(rule => rule.key === ruleKey);
                                if (customRule) {
                                    // Ïª§Ïä§ÌÖÄ Î£∞Ïùò Í∏àÏï°ÏùÑ Í∑∏ÎåÄÎ°ú ÏÇ¨Ïö© (ÏùåÏàòÎèÑ Ìè¨Ìï®)
                                    playerTotals[player].penalty += customRule.amount;
                                }
                            }
                        });
                    }
                }
            }

            // Ï¥ùÏ†ê ÌëúÏãú ÏóÖÎç∞Ïù¥Ìä∏
            const totalScores = document.getElementById('totalScores');
            totalScores.innerHTML = '';

            Object.entries(playerTotals).forEach(([player, total]) => {
                const totalElement = document.createElement('div');
                totalElement.className = 'total-score-item';
                const penaltyText = total.penalty >= 0 ? 
                    `+${total.penalty.toLocaleString()}Ïõê` : 
                    `${total.penalty.toLocaleString()}Ïõê`;
                const penaltyColor = total.penalty >= 0 ? '#e74c3c' : '#2980b9';
                
                totalElement.innerHTML = `
                    <div class="total-score-name">${player}</div>
                    <div class="total-score-value" style="font-size: 16px; color: ${penaltyColor};">
                        ${penaltyText}
                    </div>
                `;
                totalScores.appendChild(totalElement);
            });
        }

        // Î£∞ Î≥ÄÍ≤Ω Ïãú ÌôÄ ÏóÖÎç∞Ïù¥Ìä∏
        document.addEventListener('DOMContentLoaded', function() {
            // Î£∞ ÏûÖÎ†• ÌïÑÎìúÏóê Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà Ï∂îÍ∞Ä
            const ruleInputs = document.querySelectorAll('.rules-section input');
            ruleInputs.forEach(input => {
                input.addEventListener('change', function() {
                    updateRules();
                    updateHoles();
                });
            });

            // ÌîåÎ†àÏù¥Ïñ¥ ÏûÖÎ†• ÌïÑÎìúÏóê Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà Ï∂îÍ∞Ä
            document.addEventListener('input', function(e) {
                if (e.target.matches('#playerInputs input')) {
                    updateHoles();
                }
            });

            // Ï¥àÍ∏∞ ÌôÄ ÏÉùÏÑ±
            updateHoles();
            
            // Ïª§Ïä§ÌÖÄ Î£∞ ÌëúÏãú Ï¥àÍ∏∞Ìôî
            displayCustomRules();
        });

        // ÌéòÏù¥ÏßÄ ÏÉàÎ°úÍ≥†Ïπ® Ïãú Îç∞Ïù¥ÌÑ∞ Î≥¥Ï°¥
        window.addEventListener('beforeunload', function() {
            const gameData = {
                players: players,
                rules: rules,
                customRules: customRules,
                selectedRules: {}
            };

            // Í∞Å ÌôÄÏùò ÏÑ†ÌÉùÎêú Î£∞ Ï†ÄÏû•
            for (let hole = 1; hole <= 18; hole++) {
                gameData.selectedRules[hole] = {};
                for (let playerIndex = 0; playerIndex < players.length; playerIndex++) {
                    const rulesContainer = document.getElementById(`rules_${hole}_${playerIndex}`);
                    if (rulesContainer) {
                        const selectedRules = Array.from(rulesContainer.querySelectorAll('.oecd-rule.selected'))
                            .map(rule => rule.dataset.rule);
                        gameData.selectedRules[hole][playerIndex] = selectedRules;
                    }
                }
            }

            localStorage.setItem('golfOECDGame', JSON.stringify(gameData));
        });

        // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú Îç∞Ïù¥ÌÑ∞ Î≥µÏõê
        window.addEventListener('load', function() {
            const savedData = localStorage.getItem('golfOECDGame');
            if (savedData) {
                const gameData = JSON.parse(savedData);
                
                // ÌîåÎ†àÏù¥Ïñ¥ Î≥µÏõê
                if (gameData.players && gameData.players.length > 0) {
                    const playerInputs = document.getElementById('playerInputs');
                    playerInputs.innerHTML = '';
                    
                    gameData.players.forEach((player, index) => {
                        const playerDiv = document.createElement('div');
                        playerDiv.className = 'player-input';
                        playerDiv.innerHTML = `
                            <input type="text" value="${player}" maxlength="10">
                            ${index > 0 ? '<button class="remove-player-btn" onclick="removePlayer(this)">ÏÇ≠Ï†ú</button>' : ''}
                        `;
                        playerInputs.appendChild(playerDiv);
                    });
                }
                
                // Î£∞ Î≥µÏõê
                if (gameData.rules) {
                    Object.entries(gameData.rules).forEach(([key, value]) => {
                        const input = document.getElementById(key + 'Rule');
                        if (input) input.value = value;
                    });
                }
                
                // Ïª§Ïä§ÌÖÄ Î£∞ Î≥µÏõê
                if (gameData.customRules) {
                    customRules = gameData.customRules;
                    displayCustomRules();
                }
                
                updateHoles();
                
                // ÏÑ†ÌÉùÎêú Î£∞ Î≥µÏõê
                setTimeout(() => {
                    if (gameData.selectedRules) {
                        const ruleTypes = [
                            { key: 'ob', name: 'Ïò§ÎπÑ', color: '#e74c3c' },
                            { key: 'hazard', name: 'Ìï¥Ï†ÄÎìú', color: '#f39c12' },
                            { key: 'mulligan', name: 'Î©ÄÎ¶¨Í±¥', color: '#e74e22' },
                            { key: 'bunker', name: 'Î≤ôÏª§', color: '#f1c40f' },
                            { key: 'threePutt', name: 'Ïì∞Î¶¨ÌçºÌä∏', color: '#9b59b6' },
                            { key: 'tripleBogey', name: 'Ìä∏Î¶¨ÌîåÎ≥¥Í∏∞', color: '#e67e22' }
                        ];
                        
                        // Ïª§Ïä§ÌÖÄ Î£∞ Ï∂îÍ∞Ä
                        Object.entries(customRules).forEach(([name, rule]) => {
                            const color = rule.amount >= 0 ? '#6c757d' : '#2980b9';
                            ruleTypes.push({
                                key: rule.key,
                                name: name,
                                color: color
                            });
                        });

                        Object.entries(gameData.selectedRules).forEach(([hole, playerRules]) => {
                            Object.entries(playerRules).forEach(([playerIndex, selectedRules]) => {
                                const rulesContainer = document.getElementById(`rules_${hole}_${playerIndex}`);
                                if (rulesContainer) {
                                    selectedRules.forEach(ruleKey => {
                                        const selectedRule = ruleTypes.find(r => r.key === ruleKey);
                                        if (selectedRule) {
                                            const ruleElement = document.createElement('span');
                                            ruleElement.className = 'oecd-rule selected';
                                            ruleElement.dataset.rule = ruleKey;
                                            ruleElement.style.backgroundColor = selectedRule.color;
                                            ruleElement.style.borderColor = selectedRule.color;
                                            ruleElement.textContent = selectedRule.name;
                                            
                                            ruleElement.addEventListener('click', function() {
                                                this.remove();
                                                updateTotal();
                                            });

                                            rulesContainer.insertBefore(ruleElement, rulesContainer.querySelector('.add-rule-btn'));
                                        }
                                    });
                                }
                            });
                        });
                        updateTotal();
                    }
                }, 100);
            }
        });
    </script>
</body>
</html>
